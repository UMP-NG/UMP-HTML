<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="logo" href="../images/">
    <title>UMP - Marketplace</title>

    <!-- Styles -->
    <link rel="stylesheet" href="../Styles/index.css">
    <link rel="stylesheet" href="../Styles/provideranalytics.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/boxicons@latest/css/boxicons.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.0/css/all.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
</head>

<body>
    <!-- HEADER -->
    <header class="main-header">
        <a class="logo" href="/">
            <img src="../images/ump-logo.jpeg" alt="UMP Logo">
        </a>

        <div class="profile">
            <img id="profileAvatar" src="/images/guy.png" alt="Avatar" />
            <span id="profileName">Loading...</span>
        </div>


    </header>

    <section class="analytics-toggle">
        <div class="toggle-container">
            <button class="toggle-btn active" data-role="walkers">Delivery Analytics</button>
            <button class="toggle-btn" data-role="services">Service Provider Analytics</button>

        </div>
    </section>

    <section id="walkers" class="analytics-section">
        <h3>Delivery Analytics</h3>
        <div class="analytics-dashboard">
            <!-- KPI CARDS -->
            <div class="kpi-grid">
                <div class="kpi-card">
                    <h4>Total Deliveries (30 Days)</h4>
                    <p class="kpi-value accent" id="totalDeliveries">Loading...</p>
                    <small id="deliveryChange"></small>
                </div>

                <div class="kpi-card">
                    <h4>Orders Completed</h4>
                    <p class="kpi-value" id="ordersCompleted">Loading...</p>
                    <small>â†‘ Active performance</small>
                </div>

                <div class="kpi-card">
                    <h4>Average Delivery Time</h4>
                    <p class="kpi-value" id="avgDeliveryTime">Loading...</p>
                    <small>Goal: < 30 mins</small>
                </div>
            </div>

            <!-- INCOMING ORDERS SECTION -->
            <div class="incoming-orders">
                <div class="section-header">
                    <h3>Incoming Orders</h3>
                    <button id="refreshOrdersBtn" class="refresh-btn">â†» Refresh</button>
                </div>
                <div id="ordersList" class="orders-list">
                    <p>Loading incoming orders...</p>
                </div>
            </div>

            <!-- DELIVERY HISTORY -->
            <div class="recent-activity">
                <div class="section-header">
                    <h3>Recent Deliveries</h3>
                    <a href="#" class="view-all">View all</a>
                </div>

                <table class="activity-table">
                    <thead>
                        <tr>
                            <th>Order ID</th>
                            <th>Receiver</th>
                            <th>Location</th>
                            <th>Status</th>
                            <th>Earnings</th>
                        </tr>
                    </thead>
                    <tbody id="deliveryHistory">
                        <tr>
                            <td colspan="5">Loading...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="payout-status">
            <div class="payout-content">
                <h3>Walker Payout Summary</h3>

                <div class="payout-details">
                    <div class="detail">
                        <p>Available for Payout</p>
                        <p id="walkerAvailablePayout">Loading...</p>
                    </div>
                    <div class="detail">
                        <p>Next Scheduled Payout</p>
                        <p id="walkerNextPayout">Loading...</p>
                    </div>
                </div>

                <div class="payout-actions">
                    <a href="#" class="view-history" id="openPayoutForm">Update Payout Details</a>
                    <button id="walkerRequestPayoutBtn" class="request-btn">
                        Request Early Payout
                    </button>
                </div>
            </div>
        </div>

        <!-- ðŸ§¾ Payout Details Modal -->
        <div id="payoutModal" class="payout-modal">
            <div class="payout-modal__content">
                <h3 class="payout-modal__title">Update Payout Details</h3>

                <form id="payoutForm" class="payout-modal__form">
                    <label class="payout-modal__label">Bank Name</label>
                    <input type="text" id="bankName" class="payout-modal__input" required />

                    <label class="payout-modal__label">Account Number</label>
                    <input type="text" id="accountNumber" class="payout-modal__input" required maxlength="10" />

                    <div class="payout-modal__actions">
                        <button type="submit" class="payout-modal__btn payout-modal__btn--primary">
                            Save Details
                        </button>
                        <button type="button" id="closeModal" class="payout-modal__btn payout-modal__btn--secondary">
                            Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </section>

    <section id="services" class="analytics-section">
        <div class="analytics-dashboard">

            <!-- KPI CARDS -->
            <div class="kpi-grid">
                <div class="kpi-card">
                    <h4>Total Revenue (Last 30 Days)</h4>
                    <p class="kpi-value accent" id="serviceTotalRevenue">Loading...</p>
                    <small id="serviceRevenueChange"></small>
                </div>

                <div class="kpi-card">
                    <h4>Sessions Completed</h4>
                    <p class="kpi-value" id="serviceSessionsCompleted">Loading...</p>
                    <small>â†‘ Consistent activity</small>
                </div>

                <div class="kpi-card">
                    <h4>Average Rating</h4>
                    <p class="kpi-value" id="serviceAvgRating">Loading...</p>
                    <small>Based on recent sessions</small>
                </div>
            </div>

            <!-- RECENT ACTIVITY -->
            <div class="recent-activity">
                <div class="section-header">
                    <h3>Recent Sessions</h3>
                    <a href="#" class="view-all">View all</a>
                </div>

                <table class="activity-table">
                    <thead>
                        <tr>
                            <th>Session Date</th>
                            <th>Client</th>
                            <th>Service Type</th>
                            <th>Earnings</th>
                        </tr>
                    </thead>
                    <tbody id="serviceRecentSessions">
                        <tr>
                            <td colspan="4">Loading...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- SERVICES SECTION (My Services) -->
        <div class="services-section">
            <h2>My Services</h2>
            <button id="serviceAddBtn" class="request-btn">+ Add Service</button>

            <div id="serviceList" class="services-list"></div>
        </div>

        <!-- Modal Form for Adding/Editing Services -->
        <div id="serviceModal" class="modal" aria-hidden="true">
            <div class="modal-content">
                <span class="close-butn" id="serviceCloseModal">&times;</span>
                <h3 id="serviceModalTitle">Add New Service</h3>

                <form id="serviceForm" class="form-pane" enctype="multipart/form-data">
                    <input type="hidden" id="serviceId" />

                    <h3 class="form-title">ðŸ§° Offer Your Expertise</h3>

                    <!-- Name -->
                    <div class="form-group animate">
                        <input type="text" id="serviceName" name="name" placeholder=" " required />
                        <label for="serviceName">Your Name or Business Name</label>
                    </div>

                    <!-- Title -->
                    <div class="form-group animate">
                        <input type="text" id="serviceTitle" name="title" placeholder=" " required />
                        <label for="serviceTitle">Service Title (e.g., Graphics Design, Tutoring)</label>
                    </div>

                    <!-- Major (Category) -->
                    <div class="form-group animate">
                        <input type="text" id="serviceMajor" name="major" placeholder=" " required />
                        <label for="serviceMajor">Service Category (e.g., Design, Writing, Tech)</label>
                    </div>

                    <!-- Short Description -->
                    <div class="form-group animate">
                        <textarea id="serviceDesc" name="desc" placeholder=" " rows="3"></textarea>
                        <label for="serviceDesc">Short Description of Service</label>
                    </div>

                    <!-- Detailed About -->
                    <div class="form-group animate">
                        <textarea id="serviceAbout" name="about" placeholder=" " rows="3" required></textarea>
                        <label for="serviceAbout">Detailed About You / Your Service</label>
                    </div>

                    <!-- Rate -->
                    <div class="form-group animate">
                        <input type="number" id="serviceRate" name="rate" placeholder=" " required />
                        <label for="serviceRate">Service Rate (e.g., 5000)</label>
                    </div>

                    <!-- Currency -->
                    <div class="form-group animate">
                        <select id="serviceCurrency" name="currency">
                            <option value="NGN" selected>NGN</option>
                            <option value="USD">USD</option>
                            <option value="EUR">EUR</option>
                        </select>
                        <label for="serviceCurrency">Currency</label>
                    </div>

                    <!-- Package -->
                    <div class="form-group animate">
                        <select id="servicePackage" name="package">
                            <option value="">Select Package</option>
                            <option value="Basic">Basic</option>
                            <option value="Standard">Standard</option>
                            <option value="Premium">Premium</option>
                        </select>
                        <label for="servicePackage">Service Package</label>
                    </div>

                    <!-- Duration -->
                    <div class="form-group animate">
                        <input type="number" id="serviceDuration" name="duration" placeholder=" " />
                        <label for="serviceDuration">Duration (in hours or days)</label>
                    </div>

                    <!-- Certifications -->
                    <div class="form-group animate">
                        <input type="text" id="serviceCertifications" name="certifications" placeholder=" " />
                        <label for="serviceCertifications">Certifications (comma-separated)</label>
                    </div>

                    <!-- Portfolio -->
                    <div class="form-group animate">
                        <input type="text" id="servicePortfolio" name="portfolio" placeholder=" " />
                        <label for="servicePortfolio">Portfolio Links (comma-separated)</label>
                    </div>

                    <!-- Policies -->
                    <div class="form-group animate">
                        <input type="text" id="servicePolicies" name="policies" placeholder=" " />
                        <label for="servicePolicies">Policies (comma-separated)</label>
                    </div>

                    <!-- Availability Times -->
                    <div class="form-group animate availability-group">
                        <label class="availability-label">Time Slots</label>
                        <div class="availability-options">
                            <input type="checkbox" id="serviceAvailMorning" name="timeSlots" value="Morning" />
                            <label for="serviceAvailMorning">ðŸŒ… Morning</label>

                            <input type="checkbox" id="serviceAvailAfternoon" name="timeSlots" value="Afternoon" />
                            <label for="serviceAvailAfternoon">ðŸŒž Afternoon</label>

                            <input type="checkbox" id="serviceAvailEvening" name="timeSlots" value="Evening" />
                            <label for="serviceAvailEvening">ðŸŒ™ Evening</label>
                        </div>
                    </div>

                    <!-- Available toggle -->
                    <div class="form-group animate">
                        <label class="availability-label">Currently Available?</label>
                        <input type="checkbox" id="serviceAvailable" name="available" checked />
                    </div>

                    <!-- Image -->
                    <div class="form-group file-upload animate">
                        <label class="file-label">Upload a Service Image</label>
                        <input type="file" id="serviceImage" name="image" accept="image/*" />
                    </div>

                    <!-- Tags -->
                    <div class="form-group animate">
                        <input type="text" id="serviceTags" name="tags" placeholder=" " />
                        <label for="serviceTags">Tags (comma-separated, e.g. creative, web, design)</label>
                    </div>
                    <!-- Submit -->
                    <div class="form-group">
                        <button type="submit" class="btn-primary">Save Service</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- PERFORMANCE CHART -->
        <div class="visual-performance">
            <div class="section-header">
                <h3>Performance Overview</h3>
                <p class="subtext">Daily Revenue (Last 30 Days)</p>
            </div>

            <div class="chart-container">
                <canvas id="serviceEarningsChart"></canvas>
            </div>
        </div>

        <!-- RECENT MESSAGES -->
        <div class="recent-messages">
            <div class="section-header">
                <h3>Recent Messages</h3>
                <a href="#" class="view-all">View all</a>
            </div>

            <div id="serviceMessages" class="message-list">
                <!-- Messages will be loaded dynamically here -->
            </div>
        </div>

        <!-- Message Modal -->
        <div id="serviceMessageModal" class="modal">
            <div class="modal-content">
                <span class="close-butn" id="serviceCloseMessageModal">&times;</span>
                <h4 id="serviceModalSender">Sender Name</h4>
                <p id="serviceModalMessage">Full message goes here</p>

                <form id="serviceReplyForm">
                    <input type="hidden" name="receiverId" id="serviceModalReceiverId">
                    <textarea name="text" id="serviceReplyText" placeholder="Type your reply..." required></textarea>
                    <button type="submit">Send Reply</button>
                </form>
            </div>
        </div>

        <!-- 4. Payout Status & Next Steps -->
        <div class="payout-status">
            <div class="payout-content">
                <h3>Payout Summary</h3>

                <div class="payout-details">
                    <div class="detail">
                        <p>Available for Payout</p>
                        <p id="serviceAvailablePayout">Loading...</p>
                    </div>
                    <div class="detail">
                        <p>Next Scheduled Payout</p>
                        <p id="serviceNextPayout">Loading...</p>
                    </div>
                </div>

                <div class="payout-actions">
                    <a href="#" id="openServicePayoutForm" class="view-history">
                        Update Payout Details
                    </a>
                    <button class="request-btn">Request Early Payout</button>
                </div>
            </div>
        </div>

        <!-- ðŸ§¾ Service Payout Details Modal -->
        <div id="servicePayoutModal" class="service-payout-modal">
            <div class="service-payout-modal__content">
                <h3 class="service-payout-modal__title">Update Payout Details</h3>

                <form id="servicePayoutForm" class="service-payout-modal__form">
                    <label class="service-payout-modal__label">Bank Name</label>
                    <input type="text" id="serviceBankName" class="service-payout-modal__input" required />

                    <label class="service-payout-modal__label">Account Number</label>
                    <input type="text" id="serviceAccountNumber" class="service-payout-modal__input" required
                        maxlength="10" />

                    <div class="service-payout-modal__actions">
                        <button type="submit" class="service-payout-modal__btn service-payout-modal__btn--primary">
                            Save Details
                        </button>
                        <button type="button" id="closeServiceModal"
                            class="service-payout-modal__btn service-payout-modal__btn--secondary">
                            Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

    </section>


    <footer id="pageFooter">
        <div class="footer-container">
            <div class="footer-logo">
                <h2>UMP</h2>
                <p>University Marketplace â€” connecting students, products, and creativity.</p>
            </div>

            <div class="footer-links">
                <h3>Quick Links</h3>
                <ul>
                    <li><a href="#">Home</a></li>
                    <li><a href="#">Marketplace</a></li>
                    <li><a href="#">Creators</a></li>
                    <li><a href="#">About Us</a></li>
                </ul>
            </div>

            <div class="footer-links">
                <h3>Support</h3>
                <ul>
                    <li><a href="#">Help Center</a></li>
                    <li><a href="#">FAQs</a></li>
                    <li><a href="#">Report Issue</a></li>
                </ul>
            </div>

            <div class="footer-links">
                <h3>Connect</h3>
                <div class="social-icons">
                    <a href="#"><i class="fab fa-facebook-f"></i></a>
                    <a href="#"><i class="fab fa-twitter"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                    <a href="#"><i class="fab fa-linkedin-in"></i></a>
                </div>
            </div>
        </div>

        <div class="footer-bottom">
            &copy; <span id="year"></span> UMP. All rights reserved.
        </div>
    </footer>

    <script type="module" src="../functions/api.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script type="module" src="../functions/provideranalytics.js"></script>
</body>

</html>